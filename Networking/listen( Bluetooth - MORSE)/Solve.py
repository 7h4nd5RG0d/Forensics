from textwrap import wrap

morse_code = {'.-...': '&', '--..--': ',', '....-': '4', '.....': '5', '...---...': 'SOS', '-...': 'B', '-..-': 'X', '.-.': 'R', '.--': 'W', '..---': '2', '.-': 'A', '..': 'I', '..-.': 'F', '.': 'E', '.-..': 'L', '...': 'S', '..-': 'U', '..--..': '?', '.----': '1', '-.-': 'K', '-..': 'D', '-....': '6', '-...-': '=', '---': 'O', '.--.': 'P', '.-.-.-': '.', '--': 'M', '-.': 'N', '....': 'H', '.----.': "'", '...-': 'V', '--...': '7', '-.-.-.': ';', '-....-': '-', '..--.-': '_', '-.--.-': ')', '-.-.--': '!', '--.': 'G', '--.-': 'Q', '--..': 'Z', '-..-.': '/', '.-.-.': '+', '-.-.': 'C', '---...': ':', '-.--': 'Y', '-': 'T', '.--.-.': '@', '...-..-': '$', '.---': 'J', '-----': '0', '----.': '9', '.-..-.': '"', '-.--.': '(', '---..': '8', '...--': '3'}

# tshark -r secret.pcap -Y btatt -Tfields -e btatt.value | cut -c5-6 | xxd -r -p > data
raw_data = open('data').read().strip()
segments = wrap(raw_data, 2)
char_map = {
    '\x10\x00': '-',
    '\x0e\x00': '.',
    '\x2c\x00': ' '
}

results = ''.join(char_map[i] for i in segments).split()
plain_text = ''.join(morse_code[m] for m in results)

print('pctf{%s}' % plain_text)
